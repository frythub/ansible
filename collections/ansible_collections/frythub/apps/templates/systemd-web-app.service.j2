[Unit]
Description=Frythub {{ item.name }} ({{ item.env }}) web app
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User={{ app_user }}
Group={{ app_user }}
WorkingDirectory={{ repo_root }}/apps/{{ item.name }}
Environment=PATH=/usr/local/bin:/usr/bin:/bin
Environment=NODE_ENV=production
Environment=APP_ENV={{ item.env }}
Environment=PORT={{ item.port }}
EnvironmentFile=-{{ repo_root }}/apps/{{ item.name }}/.env
EnvironmentFile=-{{ repo_root }}/apps/{{ item.name }}/.env.{{ item.env }}
ExecStart=/usr/bin/pnpm start
Restart=on-failure
RestartSec=5
KillSignal=SIGINT
TimeoutStopSec=20
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
